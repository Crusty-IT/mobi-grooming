/*
  Decap CMS mobile-first overrides for /admin
  Goal: No horizontal scroll on mobile, stacked layout, full-width fields, sticky editor toolbar, responsive media library.
  Do not modify Decap CMS internals; only override via external CSS.
  Use robust selectors with [class*="..."] to tolerate generated class names.
*/

/* 1) Global: prevent horizontal overflow */
html, body {
  overflow-x: hidden !important;
}

/* Base resets within CMS app scope */
.nc-app, [class*="nc-app"], [class*="CMS"] {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* 2) Inputs and editors take full width by default */
.nc-app input,
.nc-app select,
.nc-app textarea,
[class*="nc-app"] input,
[class*="nc-app"] select,
[class*="nc-app"] textarea {
  width: 100% !important;
  max-width: 100% !important;
  box-sizing: border-box !important;
}

/* CodeMirror editors */
.nc-app .CodeMirror,
[class*="nc-app"] .CodeMirror,
[class*="Editor"] .CodeMirror {
  width: 100% !important;
  max-width: 100% !important;
}

/* Preview pane container */
.nc-app [class*="Preview"],
[class*="nc-app"] [class*="Preview"],
[class*="Editor"] [class*="Preview"] {
  width: 100% !important;
  max-width: 100% !important;
}

/* 3) Editor toolbar: sticky on mobile (and acceptable on all) */
/* Keep it within app scope to avoid affecting site */
.nc-app [class*="Toolbar"],
[class*="nc-app"] [class*="Toolbar"],
[class*="Editor"] [class*="Toolbar"] {
  position: sticky !important;
  top: 0 !important;
  z-index: 1002 !important; /* above editor content and previews */
  background: inherit; /* preserve theme */
}

/* 4) Collections and cards: help grids be fluid */
/* Make any grid of cards/list adapt */
.nc-app [class*="Grid"],
.nc-app [class*="grid"],
[class*="nc-app"] [class*="Grid"],
[class*="nc-app"] [class*="grid"] {
  grid-gap: 16px;
}

/* 5) Split panes: selectors cover react-split-pane defaults */
.nc-app [class*="Pane"],
[class*="nc-app"] [class*="Pane"] {
  min-width: 0; /* allow shrinking */
}

.nc-app [class*="Resizer"],
[class*="nc-app"] [class*="Resizer"] {
  touch-action: none;
}

/* 6) Media Library modal responsive defaults */
/* Covers various implementations (portal/dialog/modal) */
.nc-app [class*="Media"][class*="Modal"],
.nc-app [class*="Modal"][class*="Media"],
.nc-app [role="dialog"],
[class*="nc-app"] [class*="Media"][class*="Modal"],
[class*="nc-app"] [role="dialog"] {
  max-width: 100vw !important;
  width: 100vw !important;
  left: 0 !important;
  right: 0 !important;
  margin: 0 !important;
}

/* 7) Mobile: stack layout and tighten spacing */
@media (max-width: 768px) {
  /* Ensure no horizontal scrolling */
  html, body, .nc-app, [class*="nc-app"] {
    overflow-x: hidden !important;
  }

  /* App main layout: sidebar + main stack in one column */
  .nc-app [class*="Sidebar"],
  .nc-app [class*="SideBar"],
  .nc-app [class*="Nav"],
  .nc-app [class*="Main"],
  .nc-app [class*="Content"],
  [class*="nc-app"] [class*="Sidebar"],
  [class*="nc-app"] [class*="SideBar"],
  [class*="nc-app"] [class*="Nav"],
  [class*="nc-app"] [class*="Main"],
  [class*="nc-app"] [class*="Content"] {
    width: 100% !important;
    max-width: 100% !important;
    flex-basis: 100% !important;
  }

  /* Disable split view: single column editor/preview */
  .nc-app [class*="Pane"],
  [class*="nc-app"] [class*="Pane"] {
    width: 100% !important;
    max-width: 100% !important;
    flex-basis: 100% !important;
  }

  .nc-app [class*="Resizer"],
  [class*="nc-app"] [class*="Resizer"] {
    display: none !important;
  }

  /* Cards/List grids â†’ 1 column */
  .nc-app [class*="Cards"],
  .nc-app [class*="CardGrid"],
  .nc-app [class*="Grid"],
  [class*="nc-app"] [class*="Cards"],
  [class*="nc-app"] [class*="CardGrid"],
  [class*="nc-app"] [class*="Grid"] {
    display: grid !important;
    grid-template-columns: 1fr !important;
  }

  /* Ensure entries/cards themselves are full width */
  .nc-app [class*="Card"],
  [class*="nc-app"] [class*="Card"] {
    width: 100% !important;
    max-width: 100% !important;
  }

  /* Form controls full width (double-down specificity) */
  .nc-app [class*="Control"] input,
  .nc-app [class*="Control"] select,
  .nc-app [class*="Control"] textarea,
  [class*="nc-app"] [class*="Control"] input,
  [class*="nc-app"] [class*="Control"] select,
  [class*="nc-app"] [class*="Control"] textarea {
    width: 100% !important;
  }

  /* Editor toolbar sticky is already set globally, ensure shadow above content */
  .nc-app [class*="Toolbar"],
  [class*="nc-app"] [class*="Toolbar"] {
    box-shadow: 0 2px 6px rgba(0,0,0,0.08);
  }

  /* Media Library: occupy full viewport width on mobile */
  .nc-app [class*="Media"][class*="Modal"],
  [class*="nc-app"] [class*="Media"][class*="Modal"],
  .nc-app [role="dialog"],
  [class*="nc-app"] [role="dialog"] {
    width: 100vw !important;
    max-width: 100vw !important;
    height: auto;
    max-height: 100vh;
    border-radius: 0 !important;
  }
}

/* 8) Ultra-narrow devices: gentle scale-down to avoid overflow */
@media (max-width: 420px) {
  .nc-app, [class*="nc-app"] {
    transform: scale(0.92);
    transform-origin: top left;
  }
}

/* 9) Desktop safeguard: ensure desktop >= 1024px behaves as original */
@media (min-width: 1024px) {
  /* No desktop overrides; rely on CMS defaults */
}
